{
	{$CADDY_GLOBAL_OPTIONS}

	frankenphp {
		{$FRANKENPHP_CONFIG}
	}
}

{$CADDY_EXTRA_CONFIG}

{$SERVER_NAME:localhost} {
	log {
		{$CADDY_SERVER_LOG_OPTIONS}
		# Redact the authorization query parameter that can be set by Mercure
		format filter {
			request>uri query {
				replace authorization REDACTED
			}
		}
	}

	root /app/public
	encode zstd br gzip

	# Static files
	@static {
		path "/favicon.ico" "/manifest.json" "/robots.txt" "/sitemap*"
	}
	handle @static {
		file_server
	}

	@api {
    		path "/*" "/api*" "/docs*" "/events*" "/graphql*" "/bundles*" "/contexts*" "/_profiler*" "/_wdt*"
    		path "*.json*" "*.html" "*.csv" "*.yml" "*.yaml" "*.xml"
	}
	handle @api {
		php_server
	}
}
